#!/usr/bin/bash

getHex() {
  echo $(echo "ibase=16; $1" | bc)
}

ALPHA=$(echo "scale=2 ; $2 / 100" | bc)
set -- "$(echo "$1" | tr -d '#' | tr '[:lower:]' '[:upper:]')"
START=0
STR=
RGBA="rgba("
if [[ $1 == \#* ]]; then 
  set -- echo "${1:1}"
fi
while (( START < ${#1} )); do
  # double each char under len 6 : FAB => FFAABB
  if (( ${#1} < 6 )); then
    STR="$(printf "${1:${START}:1}%.0s" 1 2)"
    (( START += 1 ))
  else
    STR="${1:${START}:2}"
    (( START += 2 ))
  fi
  hex=$(getHex $STR)
  RGBA="$RGBA$hex, "
done

RGBA="${RGBA%??}, $ALPHA)"
echo $RGBA
unset START STR RGBA ALPHA
